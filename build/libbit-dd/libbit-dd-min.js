YUI.add("libbit-dd",function(e,t){var n;n=e.Base.create("dd",e.View,[],{events:{".libbit-dd-drag":{mouseenter:"_handleMouseEnter",mouseleave:"_handleMouseLeave"}},initializer:function(){e.DD.DDM.set("dragCursor","default"),this.on("drag:start",this._handleStart,this)},createDrag:function(t,n){t.addClass("libbit-dd-drag");var r=new e.DD.Drag({node:t,groups:n,bubbleTargets:this,target:!0});return r.plug(e.Plugin.DDProxy,{moveOnEnd:!1,borderStyle:"none"}),r},createDrop:function(t,n){t.addClass("libbit-dd-drop");var r=new e.DD.Drop({node:t,groups:n,bubbleTargets:this});return r},bindGlobalDrop:function(t){var n=this.get("container"),r;n.addClass("libbit-global-drop"),r=new e.DD.Drop({node:n,groups:t,bubbleTargets:null}),r.on("drop:enter",this._dropEnterGlobal,this)},_handleStart:function(e){var t=e.target,n=t.get("node").cloneNode(!0).addClass("libbit-dd-drag-proxy");t.get("dragNode").set("innerHTML",n.get("outerHTML")),t.get("node").addClass("libbit-dd-drag-placeholder")},_dropEnterGlobal:function(t){if(e.DD.DDM.activeDrag){var n=e.DD.DDM.activeDrag,r=n.get("dragNode"),i=n.get("data"),s,o;if(i.name==="fieldGroup"||i.name==="image"||i.name==="table"){n.on("drag:end",this._handleEnd,this);var o=new e.TB.TemplateItem({asset:i}),u=new e.TB.TemplateItemView({model:o});u.templateModel=this.get("model"),s=u.render().get("container"),s.plug(e.Libbit.ContextMenu,{content:[{title:"Remove from template",id:"removeTemplateItem"},{title:"-"},{title:"Properties",id:"templateItemProperties",disabled:!0}],bubbleTarget:u});var a=s.cloneNode(!0).addClass("libbit-dd-drag-proxy");s.addClass("libbit-dd-drag-placeholder"),s.setData({model:o}),n.get("node").remove(),n.set("node",s),e.Libbit.Anim.morph(r,a,e.Libbit.Anim.fadeOut,e.Libbit.Anim.slideIn)}}},_handleMouseEnter:function(e){var t=e.currentTarget;t.ancestor(".libbit-dd-drag-hover")&&t.ancestor(".libbit-dd-drag-hover").replaceClass("libbit-dd-drag-hover","libbit-dd-drag-hover-disabled"),t.one(".libbit-dd-drag-hover")?t.addClass("libbit-dd-drag-hover-disabled"):t.addClass("libbit-dd-drag-hover")},_handleMouseLeave:function(e){var t=e.currentTarget;t.hasClass("libbit-dd-drag-hover")&&t.removeClass("libbit-dd-drag-hover"),t.ancestor(".libbit-dd-drag-hover-disabled")&&t.ancestor(".libbit-dd-drag-hover-disabled").replaceClass("libbit-dd-drag-hover-disabled","libbit-dd-drag-hover")}}),e.namespace("Libbit").DD=n},"1.0.0",{requires:["view","libbit-dd-css"]});
