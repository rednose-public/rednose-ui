YUI.add("rednose-treeview",function(e,t){var n=e.Base.create("treeView",e.TreeView,[e.TreeView.Sortable,e.Rednose.Tree.Comparable,e.Rednose.Tree.Icon,e.Rednose.TreeView.Anim,e.Rednose.TreeView.DataSource,e.Rednose.TreeView.DD,e.Rednose.TreeView.Selectable],{templates:e.Rednose.TreeView.Templates,rednoseClassNames:{outer:"rednose-treeview-outer-container",inner:"rednose-treeview-inner-container",icon:"rednose-treeview-icon",header:"nav-header"},initializer:function(t){t||(t={}),e.mix(this.classNames,this.rednoseClassNames,!0),t.sortComparator||(t.sortComparator=function(e){return e.label}),t.header&&(this.header=t.header),this._stateMap=[],this._attachEventHandles(),this.onceAfter("initializedChange",function(){t.nodes&&(this.set("nodes",t.nodes),delete t.nodes)})},destructor:function(){this._stateMap=null,this._destroyContainer()},render:function(){var t=this.get("container"),n="ontouchstart"in e.config.win,r=this.header,i=e.Node.create('<div class="'+this.classNames.inner+'"></div>');return t.addClass(this.classNames.treeview),t.addClass(this.classNames[n?"touch":"noTouch"]),t.addClass(this.classNames.outer),t.append(i),r&&i.append('<div class="'+this.classNames.header+'">'+r+"</div>"),this._childrenNode=this.renderChildren(this.rootNode,{container:i}),this.rendered=!0,this},renameNode:function(e,t){e.label=t;var n;(n=e._htmlNode.one("."+this.classNames.label))&&n.set("text",e.label)},generateRednoseRecordId:function(t){return t instanceof e.Model?t.name+"_"+t.get("id"):null},parseRednoseRecordId:function(e){return e.split("_")},_attachEventHandles:function(){this._treeViewEvents||(this._treeViewEvents=[]),this._treeViewEvents.push(this.on("open",this._onExpand,this),this.on("close",this._onCollapse,this),this.after(["open","close"],this._afterToggle,this))},_restoreTreeOpenState:function(){var t=this,n=this.rootNode;n.hasChildren()&&this._stateMap&&this._stateMap.length>0&&e.Array.each(n.children,function(e){t._restoreNodeOpenState(e)})},_restoreNodeOpenState:function(t){var n=this.generateRednoseRecordId(t.data),r=this._stateMap.indexOf(n);r!==-1&&t.open({silent:!0}),t.hasChildren()&&e.Array.each(t.children,function(e){this._restoreNodeOpenState(e)},this)},_destroyContainer:function(){var e=this.get("container");e&&e.remove(!0)},_setNodes:function(e){this.clear(null,{silent:!1}),e&&this.insertNode(this.rootNode,e,{silent:!1})},_getNodes:function(){return this.rootNode.toJSON().children||[]},_afterToggle:function(e){if(this.rendered===!1)return;var t=e.node,n=this.getHTMLNode(e.node);t.icon&&n.one("."+this.classNames.icon).set("className",this.classNames.icon+" "+t.getIcon())},_onExpand:function(e){var t=this.generateRednoseRecordId(e.node.data),n=this._stateMap.indexOf(t);n===-1&&this._stateMap.push(t)},_onCollapse:function(e){var t=this.generateRednoseRecordId(e.node.data),n=this._stateMap.indexOf(t);n!==-1&&this._stateMap.splice(n,1)}},{ATTRS:{nodes:{value:[],setter:"_setNodes",getter:"_getNodes"}}});e.Rednose.TreeView=e.mix(n,e.Rednose.TreeView)},"1.5.0-DEV",{requires:["gallery-sm-treeview-sortable","rednose-model-tree","rednose-tree","rednose-treeview-anim","rednose-treeview-datasource","rednose-treeview-dd","rednose-treeview-templates","rednose-treeview-select","node"],supersedes:["gallery-sm-treeview-templates"],rollup:1});
