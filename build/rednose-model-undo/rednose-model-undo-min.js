YUI.add("rednose-model-undo",function(e,t){var n;n=e.Base.create("undo",e.Model,[],{_revisions:[],_index:0,initializer:function(){var e=this;this.on("init",function(){e._revisions=[],e._index=0,e.addAction()})},destructor:function(){this._revisions=null},addAction:function(t,n){var r=e.JSON.stringify(this.toJSON()),i;typeof t=="function"&&(n=t),typeof n=="function"&&(n(),i=e.JSON.stringify(this.toJSON())),this._index<this._revisions.length&&this._revisions.splice(this._index,this._revisions.length-this._index),this._revisions.push({label:t,undo:r,redo:i}),this._index=this._revisions.length,this.fire("change")},undo:function(){if(!this.canUndo())return;this._index--,this.setAttrs(e.JSON.parse(this._revisions[this._index].undo))},redo:function(){if(!this.canRedo())return;this._index++,this.setAttrs(e.JSON.parse(this._revisions[this._index-1].redo))},canUndo:function(){return this._index>1},canRedo:function(){return this._revisions[this._index]!==null&&this._index<this._revisions.length},getUndo:function(){return this.canUndo()?this._revisions[this._index-1].label:null},getRedo:function(){return this.canRedo()?this._revisions[this._index].label:null}}),e.namespace("Rednose.Model").Undo=n},"1.5.0-DEV",{requires:["model"]});
