YUI.add("rednose-dialog-base",function(e,t){var n="cancel",r="confirm",i="alternative",s=e.Base.create("dialog",e.Base,[],{classNames:{dialog:"rednose-dialog",close:"close"},initializer:function(){this.publish(n,{emitFacade:!1}),this.publish(r,{emitFacade:!1}),this.publish(i,{emitFacade:!1}),this.after("errorChange",this._setError,this)},destructor:function(){this.panel&&this.panel.destroy(),this.toolbar&&this.toolbar.destroy()},alert:function(t,n){t||(t={});var r=this;t=e.mix(t,{title:"",text:"",type:"primary",confirm:this.get("strings.confirm")}),t.on&&this.on(t.on),typeof n=="function"&&this.on("confirm",n),this.toolbar=(new e.Rednose.Toolbar({groups:[{position:"right",buttons:[{id:"confirm",value:t.confirm,type:t.type}]}]})).render(),this.toolbar.on("click#confirm",this._onClickConfirm,this,r),this.panel=(new e.Rednose.Panel({bodyContent:e.Node.create("<div><p>"+t.text+"</p></div>"),headerContent:this._getHeaderContent(t.title),zIndex:this._getHighzIndex(),width:this.get("width"),footerContent:this.toolbar.get("container"),buttons:null})).render(),this.panel.get("boundingBox").on("keydown",this._onPanelKeydown,this),this.panel.get("boundingBox").addClass(this.classNames.dialog),this.panel.set("zIndex",this._getHighzIndex()),this.panel.get("boundingBox").one("#confirm").focus()},confirm:function(t,n){t||(t={});var r=this,i;t=e.mix(t,{title:"",text:"",type:"primary",confirm:this.get("strings.confirm"),cancel:this.get("strings.cancel")}),t.on&&this.on(t.on),typeof n=="function"&&this.on("confirm",n),i=[{position:"right",buttons:[{id:"confirm",value:t.confirm,type:t.type}]},{position:"right",buttons:[{id:"cancel",value:t.cancel}]}],t.alternative&&i.push({position:"left",buttons:[{id:"alternative",value:t.alternative}]}),this.toolbar=(new e.Rednose.Toolbar({groups:i})).render(),this.toolbar.on("click#confirm",this._onClickConfirm,this,r),this.toolbar.on("click#cancel",this._onClickCancel,this,r),t.alternative&&this.toolbar.on("click#alternative",this._onClickAlternative,this,r),this.panel=(new e.Rednose.Panel({bodyContent:e.Node.create("<div><p>"+t.text+"</p></div>"),headerContent:this._getHeaderContent(t.title),zIndex:this._getHighzIndex(),width:this.get("width"),footerContent:this.toolbar.get("container"),buttons:null})).render(),this.panel.get("boundingBox").on("keydown",this._onPanelKeydown,this),this.panel.get("boundingBox").addClass(this.classNames.dialog),this.panel.set("zIndex",this._getHighzIndex()),this.panel.get("boundingBox").one("#confirm").focus()},prompt:function(t,n){t||(t={});var r=this,i=this,s,o;t=e.mix(t,{title:"",text:"",dataPath:"input",type:"primary",confirm:this.get("strings.confirm"),cancel:this.get("strings.cancel"),value:"",html:null});if(t.html)s=typeof t.html=="string"?e.Node.create(t.html):t.html;else{var u=e.Node.create('<input class="form-control" type="text" value="'+t.value+'" data-path="'+t.dataPath+'" id="dialog-input">');s=e.Node.create('<form class="form-horizontal">   <div class="form-group">       <label for="dialog-input" class="col-sm-2 control-label">'+t.text+"</label>"+'       <div class="col-sm-10"></div>'+"   </div>"+"</form>"),s.one(".col-sm-10").append(u)}t.on&&this.on(t.on),typeof n=="function"&&this.on("confirm",n),o=[{position:"right",buttons:[{id:"confirm",value:t.confirm,type:t.type}]},{position:"right",buttons:[{id:"cancel",value:t.cancel}]}],t.alternative&&o.push({position:"left",buttons:[{id:"alternative",value:t.alternative}]}),this.toolbar=(new e.Rednose.Toolbar({groups:o})).render(),this.toolbar.on("click#confirm",this._onClickConfirm,this,s,i),this.toolbar.on("click#cancel",this._onClickCancel,this,i),t.alternative&&this.toolbar.on("click#alternative",this._onClickAlternative,this,i),this.panel=(new e.Rednose.Panel({bodyContent:s,headerContent:this._getHeaderContent(t.title),zIndex:this._getHighzIndex(),width:this.get("width"),footerContent:this.toolbar.get("container"),buttons:null})).render(),s.all("input, textarea, select").on("keydown",function(e){e.button===13&&e.preventDefault()}),s.all("input, textarea, select").on("keyup",function(e){e.button===13&&(e.preventDefault(),r.toolbar.fire("click#confirm"))}),this.panel.get("boundingBox").on("keydown",this._onPanelKeydown,this),this.panel.get("boundingBox").addClass(this.classNames.dialog),this.panel.set("zIndex",this._getHighzIndex()),this._focusInput()},_focusInput:function(){var e=this.panel.get("boundingBox").one(".col-sm-10"),t=e?e.one("input, textarea"):null;t&&(t.focus(),t.select())},_getHeaderContent:function(t){var n=this,r;return r=e.Node.create('<div style="width: 100%;"><div style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+t+"</div>"+"</div>"),r.prepend(e.Node.create('<div style="float: right; white-space: nowrap;"><button class="'+this.classNames.close+'">&times;</button>'+"</div>")),r.one("."+this.classNames.close).on("click",function(){n.destroy()}),r},_getHighzIndex:function(){var e=document.getElementsByTagName("*"),t=0;for(var n=0;n<e.length-1;n++)parseInt(e[n].style.zIndex,10)>t&&(t=parseInt(e[n].style.zIndex,10));return t+1},_evt:function(){this.fire.apply(this,arguments)&&this.destroy()},_setError:function(t){var n=t.newVal,r=this.panel.get("boundingBox");r.all(".control-group").each(function(e){e.hasClass("error")&&e.removeClass("error"),e.all(".help-block").remove()}),e.Lang.isArray(n)||(n=[n]),e.each(n,function(e){var t=r.one("[data-path="+(e.path||"input")+"]");t.ancestor(".control-group").addClass("error"),e.message&&t.get("parentNode").append('<span class="help-block">'+e.message+"</span>")});var i=r.one(".error").one("input, textarea, select");i&&(i.focus(),i.select())},_onPanelKeydown:function(e){var t=this;e.keyCode===27&&(e.stopPropagation(),this._evt(n,t))},_onClickCancel:function(){var e=arguments;e[0]=n,this._evt.apply(this,e)},_onClickConfirm:function(){var e=arguments;typeof e[1].one=="function"&&e[1].one("#dialog-input")&&(e[1]=e[1].one("#dialog-input").get("value")),e[0]=r,this._evt.apply(this,e)},_onClickAlternative:
function(){var e=arguments;e[0]=i,this._evt.apply(this,e)}},{ATTRS:{strings:{valueFn:function(){return e.Intl.get("rednose-dialog-base")}},error:{value:null},width:{value:500,writeOnce:"initOnly"}}});s.alert=function(e,t){var n=new s;return n.alert(e,t),n},s.confirm=function(e,t){var n=new s;return n.confirm(e,t),n},s.prompt=function(e,t){var n=new s;return n.prompt(e,t),n},e.namespace("Rednose").Dialog=s},"@VERSION@",{requires:["base","rednose-panel","rednose-toolbar"],lang:["en","nl"]});
