if (typeof __coverage__ === 'undefined') { __coverage__ = {}; }
if (!__coverage__['build/rednose-treeview-dd/rednose-treeview-dd.js']) {
   __coverage__['build/rednose-treeview-dd/rednose-treeview-dd.js'] = {"path":"build/rednose-treeview-dd/rednose-treeview-dd.js","s":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0},"fnMap":{"1":{"name":"(anonymous_1)","line":1,"loc":{"start":{"line":1,"column":31},"end":{"line":1,"column":50}}},"2":{"name":"(anonymous_2)","line":25,"loc":{"start":{"line":25,"column":17},"end":{"line":25,"column":29}}},"3":{"name":"(anonymous_3)","line":31,"loc":{"start":{"line":31,"column":16},"end":{"line":31,"column":28}}},"4":{"name":"(anonymous_4)","line":41,"loc":{"start":{"line":41,"column":17},"end":{"line":41,"column":52}}},"5":{"name":"(anonymous_5)","line":52,"loc":{"start":{"line":52,"column":15},"end":{"line":52,"column":26}}},"6":{"name":"(anonymous_6)","line":62,"loc":{"start":{"line":62,"column":17},"end":{"line":62,"column":35}}},"7":{"name":"(anonymous_7)","line":66,"loc":{"start":{"line":66,"column":19},"end":{"line":66,"column":35}}},"8":{"name":"(anonymous_8)","line":89,"loc":{"start":{"line":89,"column":17},"end":{"line":89,"column":29}}},"9":{"name":"(anonymous_9)","line":104,"loc":{"start":{"line":104,"column":15},"end":{"line":104,"column":37}}},"10":{"name":"(anonymous_10)","line":132,"loc":{"start":{"line":132,"column":21},"end":{"line":132,"column":33}}},"11":{"name":"(anonymous_11)","line":150,"loc":{"start":{"line":150,"column":25},"end":{"line":150,"column":39}}},"12":{"name":"(anonymous_12)","line":159,"loc":{"start":{"line":159,"column":21},"end":{"line":159,"column":33}}},"13":{"name":"(anonymous_13)","line":166,"loc":{"start":{"line":166,"column":16},"end":{"line":166,"column":27}}},"14":{"name":"(anonymous_14)","line":178,"loc":{"start":{"line":178,"column":18},"end":{"line":178,"column":30}}},"15":{"name":"(anonymous_15)","line":183,"loc":{"start":{"line":183,"column":24},"end":{"line":183,"column":37}}},"16":{"name":"(anonymous_16)","line":189,"loc":{"start":{"line":189,"column":23},"end":{"line":189,"column":36}}},"17":{"name":"(anonymous_17)","line":195,"loc":{"start":{"line":195,"column":19},"end":{"line":195,"column":32}}},"18":{"name":"(anonymous_18)","line":202,"loc":{"start":{"line":202,"column":20},"end":{"line":202,"column":33}}},"19":{"name":"(anonymous_19)","line":208,"loc":{"start":{"line":208,"column":19},"end":{"line":208,"column":32}}},"20":{"name":"(anonymous_20)","line":215,"loc":{"start":{"line":215,"column":18},"end":{"line":215,"column":31}}},"21":{"name":"(anonymous_21)","line":246,"loc":{"start":{"line":246,"column":17},"end":{"line":246,"column":30}}},"22":{"name":"(anonymous_22)","line":261,"loc":{"start":{"line":261,"column":43},"end":{"line":261,"column":60}}},"23":{"name":"(anonymous_23)","line":284,"loc":{"start":{"line":284,"column":25},"end":{"line":284,"column":37}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":304,"column":66}},"2":{"start":{"line":5,"column":0},"end":{"line":7,"column":44}},"3":{"start":{"line":12,"column":0},"end":{"line":298,"column":3}},"4":{"start":{"line":26,"column":8},"end":{"line":26,"column":25}},"5":{"start":{"line":28,"column":8},"end":{"line":28,"column":55}},"6":{"start":{"line":32,"column":8},"end":{"line":32,"column":26}},"7":{"start":{"line":33,"column":8},"end":{"line":33,"column":31}},"8":{"start":{"line":35,"column":8},"end":{"line":35,"column":31}},"9":{"start":{"line":36,"column":8},"end":{"line":36,"column":31}},"10":{"start":{"line":42,"column":8},"end":{"line":45,"column":10}},"11":{"start":{"line":53,"column":8},"end":{"line":57,"column":9}},"12":{"start":{"line":54,"column":12},"end":{"line":56,"column":13}},"13":{"start":{"line":55,"column":16},"end":{"line":55,"column":42}},"14":{"start":{"line":63,"column":8},"end":{"line":64,"column":25}},"15":{"start":{"line":66,"column":8},"end":{"line":84,"column":11}},"16":{"start":{"line":67,"column":12},"end":{"line":67,"column":71}},"17":{"start":{"line":69,"column":12},"end":{"line":69,"column":40}},"18":{"start":{"line":72,"column":12},"end":{"line":83,"column":13}},"19":{"start":{"line":74,"column":16},"end":{"line":78,"column":19}},"20":{"start":{"line":80,"column":16},"end":{"line":80,"column":55}},"21":{"start":{"line":81,"column":16},"end":{"line":81,"column":49}},"22":{"start":{"line":82,"column":16},"end":{"line":82,"column":40}},"23":{"start":{"line":86,"column":8},"end":{"line":86,"column":42}},"24":{"start":{"line":90,"column":8},"end":{"line":91,"column":15}},"25":{"start":{"line":93,"column":8},"end":{"line":98,"column":11}},"26":{"start":{"line":100,"column":8},"end":{"line":100,"column":37}},"27":{"start":{"line":101,"column":8},"end":{"line":101,"column":29}},"28":{"start":{"line":105,"column":8},"end":{"line":107,"column":15}},"29":{"start":{"line":109,"column":8},"end":{"line":111,"column":9}},"30":{"start":{"line":110,"column":12},"end":{"line":110,"column":54}},"31":{"start":{"line":114,"column":8},"end":{"line":119,"column":11}},"32":{"start":{"line":121,"column":8},"end":{"line":124,"column":11}},"33":{"start":{"line":126,"column":8},"end":{"line":126,"column":47}},"34":{"start":{"line":127,"column":8},"end":{"line":127,"column":29}},"35":{"start":{"line":129,"column":8},"end":{"line":129,"column":18}},"36":{"start":{"line":133,"column":8},"end":{"line":133,"column":60}},"37":{"start":{"line":135,"column":8},"end":{"line":147,"column":10}},"38":{"start":{"line":151,"column":8},"end":{"line":156,"column":10}},"39":{"start":{"line":160,"column":8},"end":{"line":160,"column":59}},"40":{"start":{"line":167,"column":8},"end":{"line":171,"column":9}},"41":{"start":{"line":168,"column":12},"end":{"line":170,"column":13}},"42":{"start":{"line":169,"column":16},"end":{"line":169,"column":41}},"43":{"start":{"line":173,"column":8},"end":{"line":173,"column":31}},"44":{"start":{"line":179,"column":8},"end":{"line":179,"column":26}},"45":{"start":{"line":180,"column":8},"end":{"line":180,"column":48}},"46":{"start":{"line":184,"column":8},"end":{"line":184,"column":84}},"47":{"start":{"line":186,"column":8},"end":{"line":186,"column":59}},"48":{"start":{"line":190,"column":8},"end":{"line":190,"column":84}},"49":{"start":{"line":192,"column":8},"end":{"line":192,"column":116}},"50":{"start":{"line":196,"column":8},"end":{"line":197,"column":50}},"51":{"start":{"line":199,"column":8},"end":{"line":199,"column":35}},"52":{"start":{"line":203,"column":7},"end":{"line":205,"column":9}},"53":{"start":{"line":204,"column":12},"end":{"line":204,"column":96}},"54":{"start":{"line":210,"column":8},"end":{"line":212,"column":9}},"55":{"start":{"line":211,"column":12},"end":{"line":211,"column":105}},"56":{"start":{"line":216,"column":8},"end":{"line":220,"column":15}},"57":{"start":{"line":222,"column":8},"end":{"line":222,"column":33}},"58":{"start":{"line":224,"column":8},"end":{"line":226,"column":10}},"59":{"start":{"line":228,"column":8},"end":{"line":228,"column":103}},"60":{"start":{"line":231,"column":8},"end":{"line":231,"column":34}},"61":{"start":{"line":233,"column":8},"end":{"line":233,"column":21}},"62":{"start":{"line":235,"column":8},"end":{"line":235,"column":37}},"63":{"start":{"line":237,"column":8},"end":{"line":237,"column":49}},"64":{"start":{"line":238,"column":8},"end":{"line":238,"column":36}},"65":{"start":{"line":240,"column":8},"end":{"line":240,"column":33}},"66":{"start":{"line":241,"column":8},"end":{"line":241,"column":21}},"67":{"start":{"line":243,"column":8},"end":{"line":243,"column":43}},"68":{"start":{"line":247,"column":8},"end":{"line":250,"column":114}},"69":{"start":{"line":251,"column":12},"end":{"line":252,"column":28}},"70":{"start":{"line":254,"column":8},"end":{"line":254,"column":101}},"71":{"start":{"line":256,"column":8},"end":{"line":258,"column":9}},"72":{"start":{"line":257,"column":12},"end":{"line":257,"column":105}},"73":{"start":{"line":261,"column":8},"end":{"line":270,"column":11}},"74":{"start":{"line":262,"column":12},"end":{"line":269,"column":13}},"75":{"start":{"line":263,"column":16},"end":{"line":263,"column":52}},"76":{"start":{"line":265,"column":16},"end":{"line":265,"column":43}},"77":{"start":{"line":266,"column":16},"end":{"line":266,"column":59}},"78":{"start":{"line":268,"column":16},"end":{"line":268,"column":32}},"79":{"start":{"line":272,"column":8},"end":{"line":274,"column":9}},"80":{"start":{"line":273,"column":12},"end":{"line":273,"column":24}},"81":{"start":{"line":276,"column":8},"end":{"line":286,"column":9}},"82":{"start":{"line":277,"column":12},"end":{"line":280,"column":65}},"83":{"start":{"line":282,"column":12},"end":{"line":285,"column":13}},"84":{"start":{"line":283,"column":16},"end":{"line":283,"column":42}},"85":{"start":{"line":284,"column":16},"end":{"line":284,"column":56}},"86":{"start":{"line":284,"column":39},"end":{"line":284,"column":52}},"87":{"start":{"line":301,"column":0},"end":{"line":301,"column":40}}},"branchMap":{"1":{"line":28,"type":"binary-expr","locations":[{"start":{"line":28,"column":8},"end":{"line":28,"column":28}},{"start":{"line":28,"column":32},"end":{"line":28,"column":54}}]},"2":{"line":54,"type":"if","locations":[{"start":{"line":54,"column":12},"end":{"line":54,"column":12}},{"start":{"line":54,"column":12},"end":{"line":54,"column":12}}]},"3":{"line":72,"type":"if","locations":[{"start":{"line":72,"column":12},"end":{"line":72,"column":12}},{"start":{"line":72,"column":12},"end":{"line":72,"column":12}}]},"4":{"line":86,"type":"binary-expr","locations":[{"start":{"line":86,"column":8},"end":{"line":86,"column":19}},{"start":{"line":86,"column":23},"end":{"line":86,"column":41}}]},"5":{"line":109,"type":"if","locations":[{"start":{"line":109,"column":8},"end":{"line":109,"column":8}},{"start":{"line":109,"column":8},"end":{"line":109,"column":8}}]},"6":{"line":133,"type":"binary-expr","locations":[{"start":{"line":133,"column":8},"end":{"line":133,"column":28}},{"start":{"line":133,"column":33},"end":{"line":133,"column":58}}]},"7":{"line":168,"type":"if","locations":[{"start":{"line":168,"column":12},"end":{"line":168,"column":12}},{"start":{"line":168,"column":12},"end":{"line":168,"column":12}}]},"8":{"line":192,"type":"binary-expr","locations":[{"start":{"line":192,"column":8},"end":{"line":192,"column":58}},{"start":{"line":192,"column":62},"end":{"line":192,"column":115}}]},"9":{"line":203,"type":"if","locations":[{"start":{"line":203,"column":7},"end":{"line":203,"column":7}},{"start":{"line":203,"column":7},"end":{"line":203,"column":7}}]},"10":{"line":210,"type":"if","locations":[{"start":{"line":210,"column":8},"end":{"line":210,"column":8}},{"start":{"line":210,"column":8},"end":{"line":210,"column":8}}]},"11":{"line":250,"type":"cond-expr","locations":[{"start":{"line":250,"column":57},"end":{"line":250,"column":61}},{"start":{"line":250,"column":63},"end":{"line":250,"column":113}}]},"12":{"line":256,"type":"if","locations":[{"start":{"line":256,"column":8},"end":{"line":256,"column":8}},{"start":{"line":256,"column":8},"end":{"line":256,"column":8}}]},"13":{"line":262,"type":"if","locations":[{"start":{"line":262,"column":12},"end":{"line":262,"column":12}},{"start":{"line":262,"column":12},"end":{"line":262,"column":12}}]},"14":{"line":272,"type":"if","locations":[{"start":{"line":272,"column":8},"end":{"line":272,"column":8}},{"start":{"line":272,"column":8},"end":{"line":272,"column":8}}]},"15":{"line":276,"type":"if","locations":[{"start":{"line":276,"column":8},"end":{"line":276,"column":8}},{"start":{"line":276,"column":8},"end":{"line":276,"column":8}}]},"16":{"line":277,"type":"cond-expr","locations":[{"start":{"line":277,"column":63},"end":{"line":277,"column":71}},{"start":{"line":277,"column":74},"end":{"line":277,"column":84}}]},"17":{"line":279,"type":"cond-expr","locations":[{"start":{"line":279,"column":41},"end":{"line":279,"column":50}},{"start":{"line":279,"column":53},"end":{"line":279,"column":57}}]},"18":{"line":280,"type":"cond-expr","locations":[{"start":{"line":280,"column":41},"end":{"line":280,"column":57}},{"start":{"line":280,"column":60},"end":{"line":280,"column":64}}]},"19":{"line":282,"type":"if","locations":[{"start":{"line":282,"column":12},"end":{"line":282,"column":12}},{"start":{"line":282,"column":12},"end":{"line":282,"column":12}}]}},"code":["(function () { YUI.add('rednose-treeview-dd', function (Y, NAME) {","","/*jshint boss:true, expr:true, onevar:false */","","var DD,","","    CSS_BOOTSTRAP_ICON_WHITE = 'icon-white';","","/**"," * Drag and drop extension for the TreeView."," */","DD = Y.Base.create('dd', Y.Base, [], {","","    // -- Protected Properties -------------------------------------------------","","    _callbacks: {},","","    /**","     * DD references store","     */","    _ddMap: [],","","    // -- Lifecycle Methods ----------------------------------------------------","","    initializer: function () {","        this._ddMap = [];","","        this.get('dragdrop') && this._attachDdEvents();","    },","","    destructor: function () {","        this._destroyDd();","        this._detachDdEvents();","","        this._callbacks = null;","        this._ddMap     = null;","    },","","    // -- Public Methods -------------------------------------------------------","","    addCallback: function(group, callback, context) {","        this._callbacks[group] = {","            callback: callback,","            context: context","        };","    },","","    /**","     * Update all the the DD shims","     * Most likely used in combination with rednose-nodescroll (scrolling event).","     */","    sizeShims: function() {","        for (var i in this._ddMap) {","            if (typeof(this._ddMap[i].sizeShim) === 'function') {","                this._ddMap[i].sizeShim();","            }","        }","    },","","    // -- Protected Methods ----------------------------------------------------","","    _handleBind: function (parent) {","        var nodes = parent.one('.' + this.classNames.children).all('[data-rednose-type]:not(.rednose-treeview-drag)'),","            self  = this;","","        nodes.each(function (node) {","            var model = self.getNodeById(node.getData('node-id')).data;","","            self._createDd(node, model);","","            // FIXME: Use a more generic way to specify droppable models.","            if (model instanceof Y.TB.Category) {","                // This is a category model. Categories allow dropping.","                var catDD = new Y.DD.Drop({","                    node         : node,","                    groups       : self.get('groups'),","                    bubbleTargets: self","                });","","                node.addClass('rednose-treeview-drop');","                node.addClass('rednose-dd-drop');","                self._ddMap.push(catDD);","            }","        });","","        this.header && this._bindHeader();","    },","","    _bindHeader: function () {","        var container  = this.get('container'),","            dd;","","        dd = new Y.DD.Drop({","            node         : container.one('.nav-header'),","            // Only allow categories to drop here.","            groups       : [ Y.stamp(this) ],","            bubbleTargets: this","        });","","        this._attachHeaderEvents(dd);","        this._ddMap.push(dd);","    },","","    _createDd: function (node, data) {","        var groups = this.get('groups'),","            self   = this,","            dd;","","        if (data instanceof Y.TB.Category) {","            groups = groups.concat([ Y.stamp(this) ]);","        }","","        // Add an extra unique group for the category drags.","        dd = new Y.DD.Drag({","            node         : node,","            data         : data,","            groups       : groups,","            bubbleTargets: self","        });","","        dd.plug(Y.Plugin.DDProxy, {","            moveOnEnd  : false,","            borderStyle: 'none'","        });","","        node.addClass('rednose-treeview-drag');","        this._ddMap.push(dd);","","        return dd;","    },","","    _attachDdEvents: function () {","        this._ddEventHandles || (this._ddEventHandles = []);","","        this._ddEventHandles.push(","            // Setup the initial DD instances when the view is rendered.","            Y.Do.after(this._afterRender, this, 'render', this),","","            this.on({","                'drop:enter': this._handleDdEnter,","                'drop:exit' : this._handleDdExit,","                'drag:start': this._handleStart,","                'drop:hit'  : this._handleDrop","            }),","","            this.after('open', this._handleDdOpen)","        );","    },","","    _attachHeaderEvents: function (dd) {","        this._ddEventHandles.push(","            dd.on({","                'drop:enter': this._handleHeaderEnter,","                'drop:exit' : this._handleHeaderExit","            })","        );","    },","","    _detachDdEvents: function () {","        (new Y.EventHandle(this._ddEventHandles)).detach();","    },","","    /**","     * All DD references must be destoyed if the model is reloaded.","     */","    _destroyDd: function() {","        for (var i in this._ddMap) {","            if (this.ddMap[i]) {","                this._ddMap[i].destroy();","            }","        }","","        this._ddMap.length = 0;","    },","","    // -- Protected Event Handlers ---------------------------------------------","","    _afterRender: function () {","        this._destroyDd();","        this._handleBind(this.get('container'));","    },","","    _handleHeaderEnter: function (e) {","        var node = e.drop.get('node').ancestor('.rednose-treeview-outer-container');","","        node.addClass('rednose-treeview-drop-over-global');","    },","","    _handleHeaderExit: function (e) {","        var node = e.drop.get('node').ancestor('.rednose-treeview-outer-container');","","        node.hasClass('rednose-treeview-drop-over-global') && node.removeClass('rednose-treeview-drop-over-global');","    },","","    _handleDdOpen: function (e) {","        var treeNode = e.node,","            htmlNode = this.getHTMLNode(treeNode);","","        this._handleBind(htmlNode);","    },","","    _handleDdEnter: function (e) {","       if (e.drop.get('node').one('.rednose-treeview-icon')) {","            e.drop.get('node').one('.rednose-treeview-icon').addClass(CSS_BOOTSTRAP_ICON_WHITE);","        }","    },","","    _handleDdExit: function (e) {","        // FIXME: Ignore selected nodes","        if (!e.drop.get('node').get('parentNode').hasClass('yui3-treeview-selected')) {","            e.drop.get('node').all('.' + CSS_BOOTSTRAP_ICON_WHITE).removeClass(CSS_BOOTSTRAP_ICON_WHITE);","        }","    },","","    _handleStart: function (e) {","        var drag = e.target,","            model,","            container,","            origin,","            dd;","","        model = drag.get('data');","","        drag.get('dragNode').setContent(","            drag.get('node').get('outerHTML')","        );","","        drag.get('dragNode').all('.' + CSS_BOOTSTRAP_ICON_WHITE).removeClass(CSS_BOOTSTRAP_ICON_WHITE);","","        // Recreate the drag instance","        origin = drag.get('node');","","        drag._prep();","","        drag.detachAll('drag:start');","","        container = Y.Node.create('<div></div>');","        drag.set('node', container);","","        drag.set('target', true);","        drag._prep();","","        dd = this._createDd(origin, model);","    },","","    _handleDrop: function (e) {","        var model    = this.get('model'),","            obj      = e.drag.get('data'),","            dropNode = e.drop.get('node'),","            newCat   = dropNode.hasClass('nav-header') ? null: this.getNodeById(dropNode.getData('node-id')).data;","            callback = false,","            self     = this;","","        Y.all('.rednose-treeview-drop-over-global').removeClass('rednose-treeview-drop-over-global');","","        if (!e.drop.get('node').get('parentNode').hasClass('yui3-treeview-selected')) {","            e.drop.get('node').all('.' + CSS_BOOTSTRAP_ICON_WHITE).removeClass(CSS_BOOTSTRAP_ICON_WHITE);","        }","","        // Check for custom override callbacks","        Y.Array.each(e.drag.get('groups'), function (group) {","            if (group in self._callbacks) {","                var config = self._callbacks[group];","","                e.drop.set('data', newCat);","                config.callback.apply(config.context, [e]);","","                callback = true;","            }","        });","","        if (callback) {","            return true;","        }","","        if (obj) {","            var property      = obj instanceof Y.TB.Category ? 'parent' : 'category',","                oldCat        = obj.get(property),","                oldCatModelID = oldCat ? oldCat.id : null,","                newCatModelID = newCat ? newCat.get('id') : null;","","            if (oldCatModelID !== newCatModelID) {","                obj.set(property, newCat);","                obj.save(function () { model.load(); });","            }","        }","    }","}, {","    ATTRS: {","        dragdrop: {","            value : false","        },","","        groups: {","            value : ['rednose-treeview']","        }","    }","});","","// -- Namespace ----------------------------------------------------------------","Y.namespace('Rednose.TreeView').DD = DD;","","","}, '1.1.0-DEV', {\"requires\": [\"rednose-dd\", \"rednose-treeview\"]});","","}());"]};
}
var __cov_vWIhGrIYVTEzFsuAr4zKEg = __coverage__['build/rednose-treeview-dd/rednose-treeview-dd.js'];
__cov_vWIhGrIYVTEzFsuAr4zKEg.s['1']++;YUI.add('rednose-treeview-dd',function(Y,NAME){__cov_vWIhGrIYVTEzFsuAr4zKEg.f['1']++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['2']++;var DD,CSS_BOOTSTRAP_ICON_WHITE='icon-white';__cov_vWIhGrIYVTEzFsuAr4zKEg.s['3']++;DD=Y.Base.create('dd',Y.Base,[],{_callbacks:{},_ddMap:[],initializer:function(){__cov_vWIhGrIYVTEzFsuAr4zKEg.f['2']++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['4']++;this._ddMap=[];__cov_vWIhGrIYVTEzFsuAr4zKEg.s['5']++;(__cov_vWIhGrIYVTEzFsuAr4zKEg.b['1'][0]++,this.get('dragdrop'))&&(__cov_vWIhGrIYVTEzFsuAr4zKEg.b['1'][1]++,this._attachDdEvents());},destructor:function(){__cov_vWIhGrIYVTEzFsuAr4zKEg.f['3']++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['6']++;this._destroyDd();__cov_vWIhGrIYVTEzFsuAr4zKEg.s['7']++;this._detachDdEvents();__cov_vWIhGrIYVTEzFsuAr4zKEg.s['8']++;this._callbacks=null;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['9']++;this._ddMap=null;},addCallback:function(group,callback,context){__cov_vWIhGrIYVTEzFsuAr4zKEg.f['4']++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['10']++;this._callbacks[group]={callback:callback,context:context};},sizeShims:function(){__cov_vWIhGrIYVTEzFsuAr4zKEg.f['5']++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['11']++;for(var i in this._ddMap){__cov_vWIhGrIYVTEzFsuAr4zKEg.s['12']++;if(typeof this._ddMap[i].sizeShim==='function'){__cov_vWIhGrIYVTEzFsuAr4zKEg.b['2'][0]++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['13']++;this._ddMap[i].sizeShim();}else{__cov_vWIhGrIYVTEzFsuAr4zKEg.b['2'][1]++;}}},_handleBind:function(parent){__cov_vWIhGrIYVTEzFsuAr4zKEg.f['6']++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['14']++;var nodes=parent.one('.'+this.classNames.children).all('[data-rednose-type]:not(.rednose-treeview-drag)'),self=this;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['15']++;nodes.each(function(node){__cov_vWIhGrIYVTEzFsuAr4zKEg.f['7']++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['16']++;var model=self.getNodeById(node.getData('node-id')).data;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['17']++;self._createDd(node,model);__cov_vWIhGrIYVTEzFsuAr4zKEg.s['18']++;if(model instanceof Y.TB.Category){__cov_vWIhGrIYVTEzFsuAr4zKEg.b['3'][0]++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['19']++;var catDD=new Y.DD.Drop({node:node,groups:self.get('groups'),bubbleTargets:self});__cov_vWIhGrIYVTEzFsuAr4zKEg.s['20']++;node.addClass('rednose-treeview-drop');__cov_vWIhGrIYVTEzFsuAr4zKEg.s['21']++;node.addClass('rednose-dd-drop');__cov_vWIhGrIYVTEzFsuAr4zKEg.s['22']++;self._ddMap.push(catDD);}else{__cov_vWIhGrIYVTEzFsuAr4zKEg.b['3'][1]++;}});__cov_vWIhGrIYVTEzFsuAr4zKEg.s['23']++;(__cov_vWIhGrIYVTEzFsuAr4zKEg.b['4'][0]++,this.header)&&(__cov_vWIhGrIYVTEzFsuAr4zKEg.b['4'][1]++,this._bindHeader());},_bindHeader:function(){__cov_vWIhGrIYVTEzFsuAr4zKEg.f['8']++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['24']++;var container=this.get('container'),dd;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['25']++;dd=new Y.DD.Drop({node:container.one('.nav-header'),groups:[Y.stamp(this)],bubbleTargets:this});__cov_vWIhGrIYVTEzFsuAr4zKEg.s['26']++;this._attachHeaderEvents(dd);__cov_vWIhGrIYVTEzFsuAr4zKEg.s['27']++;this._ddMap.push(dd);},_createDd:function(node,data){__cov_vWIhGrIYVTEzFsuAr4zKEg.f['9']++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['28']++;var groups=this.get('groups'),self=this,dd;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['29']++;if(data instanceof Y.TB.Category){__cov_vWIhGrIYVTEzFsuAr4zKEg.b['5'][0]++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['30']++;groups=groups.concat([Y.stamp(this)]);}else{__cov_vWIhGrIYVTEzFsuAr4zKEg.b['5'][1]++;}__cov_vWIhGrIYVTEzFsuAr4zKEg.s['31']++;dd=new Y.DD.Drag({node:node,data:data,groups:groups,bubbleTargets:self});__cov_vWIhGrIYVTEzFsuAr4zKEg.s['32']++;dd.plug(Y.Plugin.DDProxy,{moveOnEnd:false,borderStyle:'none'});__cov_vWIhGrIYVTEzFsuAr4zKEg.s['33']++;node.addClass('rednose-treeview-drag');__cov_vWIhGrIYVTEzFsuAr4zKEg.s['34']++;this._ddMap.push(dd);__cov_vWIhGrIYVTEzFsuAr4zKEg.s['35']++;return dd;},_attachDdEvents:function(){__cov_vWIhGrIYVTEzFsuAr4zKEg.f['10']++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['36']++;(__cov_vWIhGrIYVTEzFsuAr4zKEg.b['6'][0]++,this._ddEventHandles)||(__cov_vWIhGrIYVTEzFsuAr4zKEg.b['6'][1]++,this._ddEventHandles=[]);__cov_vWIhGrIYVTEzFsuAr4zKEg.s['37']++;this._ddEventHandles.push(Y.Do.after(this._afterRender,this,'render',this),this.on({'drop:enter':this._handleDdEnter,'drop:exit':this._handleDdExit,'drag:start':this._handleStart,'drop:hit':this._handleDrop}),this.after('open',this._handleDdOpen));},_attachHeaderEvents:function(dd){__cov_vWIhGrIYVTEzFsuAr4zKEg.f['11']++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['38']++;this._ddEventHandles.push(dd.on({'drop:enter':this._handleHeaderEnter,'drop:exit':this._handleHeaderExit}));},_detachDdEvents:function(){__cov_vWIhGrIYVTEzFsuAr4zKEg.f['12']++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['39']++;new Y.EventHandle(this._ddEventHandles).detach();},_destroyDd:function(){__cov_vWIhGrIYVTEzFsuAr4zKEg.f['13']++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['40']++;for(var i in this._ddMap){__cov_vWIhGrIYVTEzFsuAr4zKEg.s['41']++;if(this.ddMap[i]){__cov_vWIhGrIYVTEzFsuAr4zKEg.b['7'][0]++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['42']++;this._ddMap[i].destroy();}else{__cov_vWIhGrIYVTEzFsuAr4zKEg.b['7'][1]++;}}__cov_vWIhGrIYVTEzFsuAr4zKEg.s['43']++;this._ddMap.length=0;},_afterRender:function(){__cov_vWIhGrIYVTEzFsuAr4zKEg.f['14']++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['44']++;this._destroyDd();__cov_vWIhGrIYVTEzFsuAr4zKEg.s['45']++;this._handleBind(this.get('container'));},_handleHeaderEnter:function(e){__cov_vWIhGrIYVTEzFsuAr4zKEg.f['15']++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['46']++;var node=e.drop.get('node').ancestor('.rednose-treeview-outer-container');__cov_vWIhGrIYVTEzFsuAr4zKEg.s['47']++;node.addClass('rednose-treeview-drop-over-global');},_handleHeaderExit:function(e){__cov_vWIhGrIYVTEzFsuAr4zKEg.f['16']++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['48']++;var node=e.drop.get('node').ancestor('.rednose-treeview-outer-container');__cov_vWIhGrIYVTEzFsuAr4zKEg.s['49']++;(__cov_vWIhGrIYVTEzFsuAr4zKEg.b['8'][0]++,node.hasClass('rednose-treeview-drop-over-global'))&&(__cov_vWIhGrIYVTEzFsuAr4zKEg.b['8'][1]++,node.removeClass('rednose-treeview-drop-over-global'));},_handleDdOpen:function(e){__cov_vWIhGrIYVTEzFsuAr4zKEg.f['17']++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['50']++;var treeNode=e.node,htmlNode=this.getHTMLNode(treeNode);__cov_vWIhGrIYVTEzFsuAr4zKEg.s['51']++;this._handleBind(htmlNode);},_handleDdEnter:function(e){__cov_vWIhGrIYVTEzFsuAr4zKEg.f['18']++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['52']++;if(e.drop.get('node').one('.rednose-treeview-icon')){__cov_vWIhGrIYVTEzFsuAr4zKEg.b['9'][0]++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['53']++;e.drop.get('node').one('.rednose-treeview-icon').addClass(CSS_BOOTSTRAP_ICON_WHITE);}else{__cov_vWIhGrIYVTEzFsuAr4zKEg.b['9'][1]++;}},_handleDdExit:function(e){__cov_vWIhGrIYVTEzFsuAr4zKEg.f['19']++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['54']++;if(!e.drop.get('node').get('parentNode').hasClass('yui3-treeview-selected')){__cov_vWIhGrIYVTEzFsuAr4zKEg.b['10'][0]++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['55']++;e.drop.get('node').all('.'+CSS_BOOTSTRAP_ICON_WHITE).removeClass(CSS_BOOTSTRAP_ICON_WHITE);}else{__cov_vWIhGrIYVTEzFsuAr4zKEg.b['10'][1]++;}},_handleStart:function(e){__cov_vWIhGrIYVTEzFsuAr4zKEg.f['20']++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['56']++;var drag=e.target,model,container,origin,dd;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['57']++;model=drag.get('data');__cov_vWIhGrIYVTEzFsuAr4zKEg.s['58']++;drag.get('dragNode').setContent(drag.get('node').get('outerHTML'));__cov_vWIhGrIYVTEzFsuAr4zKEg.s['59']++;drag.get('dragNode').all('.'+CSS_BOOTSTRAP_ICON_WHITE).removeClass(CSS_BOOTSTRAP_ICON_WHITE);__cov_vWIhGrIYVTEzFsuAr4zKEg.s['60']++;origin=drag.get('node');__cov_vWIhGrIYVTEzFsuAr4zKEg.s['61']++;drag._prep();__cov_vWIhGrIYVTEzFsuAr4zKEg.s['62']++;drag.detachAll('drag:start');__cov_vWIhGrIYVTEzFsuAr4zKEg.s['63']++;container=Y.Node.create('<div></div>');__cov_vWIhGrIYVTEzFsuAr4zKEg.s['64']++;drag.set('node',container);__cov_vWIhGrIYVTEzFsuAr4zKEg.s['65']++;drag.set('target',true);__cov_vWIhGrIYVTEzFsuAr4zKEg.s['66']++;drag._prep();__cov_vWIhGrIYVTEzFsuAr4zKEg.s['67']++;dd=this._createDd(origin,model);},_handleDrop:function(e){__cov_vWIhGrIYVTEzFsuAr4zKEg.f['21']++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['68']++;var model=this.get('model'),obj=e.drag.get('data'),dropNode=e.drop.get('node'),newCat=dropNode.hasClass('nav-header')?(__cov_vWIhGrIYVTEzFsuAr4zKEg.b['11'][0]++,null):(__cov_vWIhGrIYVTEzFsuAr4zKEg.b['11'][1]++,this.getNodeById(dropNode.getData('node-id')).data);__cov_vWIhGrIYVTEzFsuAr4zKEg.s['69']++;callback=false,self=this;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['70']++;Y.all('.rednose-treeview-drop-over-global').removeClass('rednose-treeview-drop-over-global');__cov_vWIhGrIYVTEzFsuAr4zKEg.s['71']++;if(!e.drop.get('node').get('parentNode').hasClass('yui3-treeview-selected')){__cov_vWIhGrIYVTEzFsuAr4zKEg.b['12'][0]++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['72']++;e.drop.get('node').all('.'+CSS_BOOTSTRAP_ICON_WHITE).removeClass(CSS_BOOTSTRAP_ICON_WHITE);}else{__cov_vWIhGrIYVTEzFsuAr4zKEg.b['12'][1]++;}__cov_vWIhGrIYVTEzFsuAr4zKEg.s['73']++;Y.Array.each(e.drag.get('groups'),function(group){__cov_vWIhGrIYVTEzFsuAr4zKEg.f['22']++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['74']++;if(group in self._callbacks){__cov_vWIhGrIYVTEzFsuAr4zKEg.b['13'][0]++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['75']++;var config=self._callbacks[group];__cov_vWIhGrIYVTEzFsuAr4zKEg.s['76']++;e.drop.set('data',newCat);__cov_vWIhGrIYVTEzFsuAr4zKEg.s['77']++;config.callback.apply(config.context,[e]);__cov_vWIhGrIYVTEzFsuAr4zKEg.s['78']++;callback=true;}else{__cov_vWIhGrIYVTEzFsuAr4zKEg.b['13'][1]++;}});__cov_vWIhGrIYVTEzFsuAr4zKEg.s['79']++;if(callback){__cov_vWIhGrIYVTEzFsuAr4zKEg.b['14'][0]++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['80']++;return true;}else{__cov_vWIhGrIYVTEzFsuAr4zKEg.b['14'][1]++;}__cov_vWIhGrIYVTEzFsuAr4zKEg.s['81']++;if(obj){__cov_vWIhGrIYVTEzFsuAr4zKEg.b['15'][0]++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['82']++;var property=obj instanceof Y.TB.Category?(__cov_vWIhGrIYVTEzFsuAr4zKEg.b['16'][0]++,'parent'):(__cov_vWIhGrIYVTEzFsuAr4zKEg.b['16'][1]++,'category'),oldCat=obj.get(property),oldCatModelID=oldCat?(__cov_vWIhGrIYVTEzFsuAr4zKEg.b['17'][0]++,oldCat.id):(__cov_vWIhGrIYVTEzFsuAr4zKEg.b['17'][1]++,null),newCatModelID=newCat?(__cov_vWIhGrIYVTEzFsuAr4zKEg.b['18'][0]++,newCat.get('id')):(__cov_vWIhGrIYVTEzFsuAr4zKEg.b['18'][1]++,null);__cov_vWIhGrIYVTEzFsuAr4zKEg.s['83']++;if(oldCatModelID!==newCatModelID){__cov_vWIhGrIYVTEzFsuAr4zKEg.b['19'][0]++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['84']++;obj.set(property,newCat);__cov_vWIhGrIYVTEzFsuAr4zKEg.s['85']++;obj.save(function(){__cov_vWIhGrIYVTEzFsuAr4zKEg.f['23']++;__cov_vWIhGrIYVTEzFsuAr4zKEg.s['86']++;model.load();});}else{__cov_vWIhGrIYVTEzFsuAr4zKEg.b['19'][1]++;}}else{__cov_vWIhGrIYVTEzFsuAr4zKEg.b['15'][1]++;}}},{ATTRS:{dragdrop:{value:false},groups:{value:['rednose-treeview']}}});__cov_vWIhGrIYVTEzFsuAr4zKEg.s['87']++;Y.namespace('Rednose.TreeView').DD=DD;},'1.1.0-DEV',{'requires':['rednose-dd','rednose-treeview']});
