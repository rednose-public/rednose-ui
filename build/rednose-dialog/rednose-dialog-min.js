YUI.add("rednose-dialog",function(e,t){var n="rednose-widget",r="rednose-dialog",i="pull-left",s="pull-right",o="btn",u="btn-warning",a="btn-primary",f="btn-danger",l="btn-info",c="btn-success",h="close",p="default",d="info",v="success",m="warning",g="danger",y="error",b=e.Base.create("dialog",e.Base,[],{initializer:function(){var t=this;this.after("errorChange",this._setError,this),e.on("keydown",function(e){e.keyCode===27&&t.destroy()})},destructor:function(){this.panel&&this.panel.destroy(),this.toolbar&&this.toolbar.destroy()},alert:function(t){t||(t={}),t=e.mix(t,{title:"",text:"",type:"default",confirm:this.get("strings.confirm")}),this.toolbar=(new e.Rednose.Toolbar({groups:[{position:"right",buttons:[{id:"confirm",value:t.confirm,type:t.type}]}]})).render(),this.toolbar.on("click#confirm",function(){this.destroy()},this),this.panel=(new e.Rednose.Panel({bodyContent:e.Node.create("<div><p>"+t.text+"</p></div>"),headerContent:this._getHeaderContent(t.title),zIndex:this._getHighzIndex(),width:this.get("width"),footerContent:this.toolbar.get("container"),buttons:null})).render(),this._setPanelStyle(),this.panel.set("zIndex",this._getHighzIndex())},confirm:function(t,n,r){t||(t={}),t=e.mix(t,{title:"",text:"",type:"default",confirm:this.get("strings.confirm"),cancel:this.get("strings.cancel")});var i=[{position:"right",buttons:[{id:"confirm",value:t.confirm,type:t.type}]},{position:"right",buttons:[{id:"cancel",value:t.cancel}]}];t.alt&&i.push({position:"left",buttons:[{id:"alt",value:t.alt}]}),this.toolbar=(new e.Rednose.Toolbar({groups:i})).render(),this.toolbar.on("click#cancel",function(){this.destroy()},this),this.toolbar.on("click#confirm",function(){typeof n=="function"&&n(),this.destroy()},this),t.alt&&this.toolbar.on("click#alt",function(){typeof r=="function"&&r(),this.destroy()},this),this.panel=(new e.Rednose.Panel({bodyContent:e.Node.create("<div><p>"+t.text+"</p></div>"),headerContent:this._getHeaderContent(t.title),zIndex:this._getHighzIndex(),width:this.get("width"),footerContent:this.toolbar.get("container"),buttons:null})).render(),this._setPanelStyle(),this.panel.set("zIndex",this._getHighzIndex())},prompt:function(t,n){t||(t={});var r=this,i;t=e.mix(t,{title:"",text:"",dataPath:"input",type:p,confirm:this.get("strings.confirm"),cancel:this.get("strings.cancel"),value:"",html:null}),t.html?(typeof t.html=="string"?input=e.Node.create(t.html):input=t.html,i=e.Node.create('<form class="form-horizontal"></form>'),i.append(input)):(input=e.Node.create('<input type="text" value="'+t.value+'" data-path="'+t.dataPath+'" id="input">'),i=e.Node.create('<form class="form-horizontal">   <div class="control-group">       <label for="input" class="control-label">'+t.text+"</label>"+'       <div class="controls"></div>'+"   </div>"+"</form>"),i.one(".controls").append(input)),this.panel=(new e.Rednose.Panel({bodyContent:i,headerContent:this._getHeaderContent(t.title),zIndex:this._getHighzIndex(),width:this.get("width"),buttons:[{value:t.cancel,section:e.WidgetStdMod.FOOTER,action:function(){r.destroy()},classNames:o},{value:t.confirm,section:e.WidgetStdMod.FOOTER,isDefault:!0,action:function(){if(typeof n=="function"){var e=t.html?i:i.one("#input").get("value");n(e)===!0&&r.destroy()}},classNames:o+" "+this._getButtonForType(t.type)}].reverse()})).render(),i.one("input, textarea, select")!==null&&(i.one("input, textarea, select").on("keydown",function(e){e.button===13&&e.preventDefault()}),i.one("input, textarea, select").on("keyup",function(t){if(t.button===13){t.preventDefault();var n=panel.get("buttons");e.Array.each(n.footer,function(e){e.hasClass(a)&&e.simulate("click")})}})),this._setPanelStyle(),this.panel.set("zIndex",this._getHighzIndex())},addButtons:function(t){if(!this.get.panel)return;var n=e.guid(),r=this.panel.get("boundingBox"),u=o,a=this;e.Array.each(t,function(t){t.position&&t.position==="right"?u+=" "+s:u+=" "+i,t.classNames&&(u+=" "+t.classNames),a.panel.addButton({name:n,title:t.value,classNames:u,action:t.callback});if(t.icon){var r=a.panel.getButton(n);r.append(e.Node.create('<li class="'+t.icon+'" />'))}}),r.all(".yui3-button").each(function(e){e.removeClass("yui3-button").removeClass("yui3-button-primary")})},_setPanelStyle:function(){var e=this.panel.get("boundingBox");e.addClass(n),e.addClass(r),e.all(".yui3-widget-buttons").each(function(e){e.removeClass("yui3-widget-buttons")}),e.all(".yui3-button").each(function(e){e.removeClass("yui3-button").removeClass("yui3-button-primary"),e.addClass(s)})},_getButtonForType:function(e){switch(e){case p:return a;case d:return l;case v:return c;case m:return u;case g:case y:return f;default:return a}},_getHeaderContent:function(t){var n=this,r;return r=e.Node.create('<div style="width: 100%;"><div style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+t+"</div>"+"</div>"),r.prepend(e.Node.create('<div style="float: right; white-space: nowrap;"><button class="'+h+'">&times;</button>'+"</div>")),r.one("."+h).on("click",function(){n.destroy()}),r},_setError:function(t){var n=t.newVal,r=this.panel.get("boundingBox"),i;r.all(".control-group").each(function(e){e.hasClass("error")&&e.removeClass("error"),e.all(".help-block").remove()}),e.Lang.isArray(n)||(n=[n]),e.each(n,function(e){i=r.one("[data-path="+(e.path||"input")+"]"),i.ancestor(".control-group").addClass("error"),e.message&&i.get("parentNode").append('<span class="help-block">'+e.message+"</span>")}),r.one(".error").focus()},_getHighzIndex:function(){var e=document.getElementsByTagName("*"),t=0;for(var n=0;n<e.length-1;n++)parseInt(e[n].style.zIndex,10)>t&&(t=parseInt(e[n].style.zIndex,10));return t+1}},{ATTRS:{strings:{valueFn:function(){return e.Intl.get("rednose-dialog")}},error:{value:{}},width:{value:500}}});b.alert=function(e){var t=new b;return t.alert(e),t},b.confirm=function(e,t){var n=new b;return n.confirm(e,t),n},b.prompt=function(e,t){var n=new b;return n.prompt(e,t),n},e.namespace("Rednose").Dialog=b},"1.5.0-DEV",{requires:["base"
,"rednose-panel","rednose-toolbar"],lang:["en","nl"]});
