YUI.add("rednose-dataprovider",function(e,t){var n;n=e.Base.create("dataProvider",e.Base,[],{ac:null,template:'<div class="dataprovider-form"><div class="input-append"><input type="text" class="dataprovider-search" placeholder="{placeholder}" /><button class="btn btn dataprovider-button" type="button">...</button></div><div class="ac"></div></div>',formatterTemplate:'<div class="entry"><div class="hd"><img src="{img}" class="photo" /></div><div class="bd"><div class="autocomplete-title">{title}</div><div class="autocomplete-subtitle">{subtitle}</div></div></div>',initializer:function(){var t=this,n=this.get("srcNode"),r="rednose_dataprovider_data_list",i=n.getAttribute("data-provider-id");parameterBag=n.getAttribute("data-json-parameterbag"),placeHolder=n.getAttribute("placeholder");var s=function(n,r){return e.Array.map(r,function(n){return e.Lang.sub(t.formatterTemplate,{img:n.raw.img,title:n.highlighted,subtitle:n.raw.subtitle})})},o=n.ancestor();o.append(e.Lang.sub(this.template,{placeholder:placeHolder})),o.one(".dataprovider-button").on("click",function(e){t._handleComboButton(e)}),r=Routing.generate(r)+"?id="+i+"&parameterbag="+parameterBag+"&q={query}&callback={callback}",n.hide(),this.ac=new e.AutoCompleteList({inputNode:o.one(".dataprovider-search"),resultFormatter:s,minQueryLength:0,maxResults:0,resultHighlighter:"phraseMatch",resultListLocator:"results",resultTextLocator:this.get("display_handle"),source:r,render:o.one(".ac")}),this.ac.after("select",function(e){this.fire("selected",e.result)})},_handleComboButton:function(e){var t=this.ac;e.stopPropagation(),t.get("visible")?t.hide():(t.sendRequest(),t.show())}},{ATTRS:{srcNode:{value:null},display_handle:{value:"display_name"}}}),e.namespace("Rednose").DataProvider=n},"1.1.0-DEV",{requires:["base","autocomplete","autocomplete-filters","autocomplete-highlighters"],skinnable:!1});
