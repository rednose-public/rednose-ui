YUI.add("rednose-dropdown",function(e,t){var n=e.Template.Micro,r="select",i=e.Base.create("dropdown",e.View,[],{templates:{wrapper:n.compile('<div class="<%= data.classNames.wrapper %>"></div>'),caret:n.compile('<%== data.content %> <span class="<%= data.classNames.caret %>"></span>'),menu:n.compile('<ul class="<%= data.classNames.menu %>"></ul>'),item:n.compile('<% if (data.item.type === "divider") { %><li class="<%= data.classNames.divider %>"></li><% } else { %><li class="<% if (data.item.disabled) { %><%= data.classNames.disabled %> <% } %><% if (data.item.children) { %><%= data.classNames.submenu %><% } %>"><a href="#" data-id="<%= data.item.id %>"><% if (data.item.icon) { %><i class="<%= data.classNames.icon %> <%= data.item.icon %>"></i> <% } %><%= data.item.title %></a></li><% } %>')},classNames:{wrapper:"rednose-dropdown-wrapper",disabled:"disabled",caret:"caret",menu:"dropdown-menu",toggle:"dropdown-toggle",open:"open",divider:"divider",dropdown:"dropdown",dropup:"dropup",icon:"icon",submenu:"dropdown-submenu"},rendered:!1,initializer:function(){var e=this.get("container"),t=this.classNames;e.addClass(t.dropdown),e.delegate("click",this._handleItemClick,"."+t.menu+" a",this),this.set("dropdownContainer",e)},destructor:function(){},render:function(){var t=this.get("dropdownContainer"),n=this.get("items");return n&&t.append(this._renderMenu(n)),t.inDoc()||e.one("body").append(t),this.rendered=!0,this},toggle:function(t){this.rendered||this.render();var n=this.get("dropdownContainer"),r=this.classNames;n.toggleClass(r.open),e.Lang.isArray(t)&&n.setStyles({position:"absolute",left:t[0],top:t[1]}),n.once("clickoutside",function(){n.toggleClass(r.open)})},enable:function(e){var t=this._getNodeByID(e);t.hasClass(this.classNames.disabled)&&t.removeClass(this.classNames.disabled)},disable:function(e){var t=this._getNodeByID(e);t.addClass(this.classNames.disabled)},rename:function(e,t){var n=this.get("node"),r=n.one("[data-id="+e+"]");r.setHTML(t)},_getNodeByID:function(e){var t=this.get("dropdownContainer");return t.one("[data-id="+e+"]").get("parentNode")},_renderMenu:function(t){var n=e.Node.create(this.templates.menu({classNames:this.classNames}));for(var r=0,i=t.length;r<i;r++)n.append(this._renderItem(t[r]));return n},_renderItem:function(t){var n=e.Node.create(this.templates.item({classNames:this.classNames,item:t}));return t.children&&n.append(this._renderMenu(t.children)),n},_handleAnchorContextMenu:function(e){if(e.shiftKey)return;e.preventDefault(),this.toggle([e.pageX,e.pageY])},_handleAnchorClick:function(e){e.preventDefault(),this.toggle()},_handleItemClick:function(e){e.preventDefault();var t=e.target;if(t.get("parentNode").hasClass(this.classNames.submenu))return;if(t.get("parentNode").hasClass(this.classNames.disabled))return;this.toggle(),this.fire(r,{originEvent:e.originEvent,id:t.hasAttribute("data-id")?t.getAttribute("data-id"):null});if(t.hasAttribute("data-id")){var n=r+"#"+t.getAttribute("data-id");this.fire(n,{originEvent:e.originEvent,id:t.getAttribute("data-id")})}}},{NS:"dropdown",ATTRS:{srcNode:{setter:e.one,writeOnce:"initOnly"},items:{value:null}}});e.namespace("Rednose").Dropdown=i,e.namespace("Rednose.Plugin").Dropdown=e.Base.create("dropdown",e.Rednose.Dropdown,[e.Plugin.Base],{initializer:function(e){var t=e.host,n=t.get("parentNode"),r=this.get("dropup"),i=this.classNames;n.addClass(i.dropdown),r&&n.addClass(i.dropup),this.get("showOnContext")||(t.addClass(i.toggle),this.set("dropdownContainer",n),this.get("showCaret")&&t.setHTML(this.templates.caret({classNames:i,content:t.getHTML()})),n.delegate("click",this._handleItemClick,"."+i.menu+" a",this)),this.get("showOnContext")?t.on("contextmenu",this._handleAnchorContextMenu,this):t.on("click",this._handleAnchorClick,this)}},{NS:"dropdown",ATTRS:{showCaret:{value:!0,writeOnce:"initOnly"},showOnContext:{value:!1,writeOnce:"initOnly"},dropup:{value:!1}}})},"1.4.0",{requires:["base","node","template-micro","view","node-pluginhost","plugin"]});
