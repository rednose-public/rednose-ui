YUI.add("rednose-dropdown",function(e,t){var n=e.Template.Micro,r="select",i=e.Base.create("dropdown",e.View,[],{templates:{wrapper:n.compile('<div class="<%= data.classNames.wrapper %>"></div>'),caret:n.compile('<%== data.content %> <span class="<%= data.classNames.caret %>"></span>')},classNames:{wrapper:"rednose-dropdown-wrapper",disabled:"disabled",caret:"caret",menu:"dropdown-menu",toggle:"dropdown-toggle",open:"open",divider:"divider",dropdown:"dropdown",dropup:"dropup"},rendered:!1,initializer:function(){var t=this.get("srcNode"),n=this.get("anchorNode"),r=this.get("dropup"),i=this.classNames,s=this.templates;t?(this.parentnode=t.get("parentNode"),this.set("anchorNode",t)):(this.get("showOnContext")?(this.parentnode=e.Node.create(s.wrapper({classNames:i})),e.one("body").append(this.parentnode)):(this.parentnode=n.get("parentNode"),n.addClass(i.toggle),n.setAttribute("data-toggle","dropdown"),this.get("showCaret")&&n.setHTML(s.caret({classNames:i,content:n.getHTML()}))),this.parentnode.addClass(r?i.dropup:i.dropdown)),this.get("showOnContext")?this.get("anchorNode").on("contextmenu",this._handleAnchorContextMenu,this):this.get("anchorNode").on("click",this._handleAnchorClick,this),this.parentnode.delegate("click",this._handleItemClick,"."+i.menu+" a",this)},destructor:function(){},render:function(){var e=this.get("items");return this.parentnode.append(this._buildHTML(e)),this.rendered=!0,this},toggle:function(t){this.rendered||this.render();var n=this.parentnode,r=this.classNames;n.toggleClass(r.open),e.Lang.isArray(t)&&n.setStyles({position:"absolute",left:t[0],top:t[1]}),n.once("clickoutside",function(e){n.toggleClass(r.open)})},enable:function(e){this.disable(e)},disable:function(e){var t=this.get("node"),n=t.one("[data-id="+e+"]");n.ancestor("li").hasClass(this.classNames.disabled)?(n.removeClass(this.classNames.disabled),n.ancestor("li").removeClass(this.classNames.disabled)):(n.addClass(this.classNames.disabled),n.ancestor("li").addClass(this.classNames.disabled))},rename:function(e,t){var n=this.get("node"),r=n.one("[data-id="+e+"]");r.setHTML(t)},_buildHTML:function(t){var n='<ul class="dropdown-menu"></ul>',r=e.Node.create(n);return e.Array.each(t,function(t){var n=e.Node.create("<li>"),i=e.Node.create('<a href="#">'),s=t.title;t.className&&n.addClass(t.className),t.title!=="-"?(t.icon&&(s='<i class="icon '+t.icon+'"></i> '+s),i.set("innerHTML",s),i.setAttribute("data-id",t.id),n.append(i),t.disabled===!0&&(n.addClass("disabled"),i.addClass("disabled"))):n.addClass("divider"),r.append(n)}),r.get("outerHTML")},_handleAnchorContextMenu:function(e){if(e.shiftKey)return;e.preventDefault(),this.toggle([e.pageX,e.pageY])},_handleAnchorClick:function(e){e.preventDefault(),this.toggle()},_handleItemClick:function(e){e.preventDefault();var t=e.target;if(t.get("parentNode").hasClass(this.classNames.disabled))return;this.toggle(),this.fire(r,{originEvent:e.originEvent,id:t.hasAttribute("data-id")?t.getAttribute("data-id"):null}),t.hasAttribute("data-id")&&this.fire(r+"#"+t.getAttribute("data-id"),{originEvent:e.originEvent,id:t.getAttribute("data-id")})}},{NS:"dropdown",ATTRS:{srcNode:{setter:e.one,writeOnce:"initOnly"},anchorNode:{setter:e.one},items:{value:null},showCaret:{value:!0},showOnContext:{value:!1,writeOnce:"initOnly"},dropup:{value:!1}}});e.namespace("Rednose").Dropdown=i},"1.4.0",{requires:["base","node","template-micro","view"]});
